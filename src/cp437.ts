const CP437_TABLE = [
  'Ç', 'ü', 'é', 'â', 'ä', 'à', 'å', 'ç',
  'ê', 'ë', 'è', 'ï', 'î', 'ì', 'Ä', 'Å',
  'É', 'æ', 'Æ', 'ô', 'ö', 'ò', 'û', 'ù',
  'ÿ', 'Ö', 'Ü', '¢', '£', '¥', '₧', 'ƒ',
  'á', 'í', 'ó', 'ú', 'ñ', 'Ñ', 'ª', 'º',
  '¿', '⌐', '¬', '½', '¼', '¡', '«', '»',
  '░', '▒', '▓', '│', '┤', 'Á', 'Â', 'À',
  '©', '╣', '║', '╗', '╝', '╜', '╛', '┐',
  '└', '┴', '┬', '├', '─', '┼', 'ã', 'Ã',
  '╚', '╔', '╩', '╦', '╠', '═', '╬', '¤',
  'ð', 'Ð', 'Ê', 'Ë', 'È', 'ı', 'Í', 'Î',
  'Ï', '┘', '┌', '█', '▄', '¦', 'Ì', '▀',
  'Ó', 'ß', 'Ô', 'Ò', 'õ', 'Õ', 'µ', 'þ',
  'Þ', 'Ú', 'Û', 'Ù', 'ý', 'Ý', '¯', '´',
  '≡', '±', '‗', '¾', '¶', '§', '÷', '¸',
  '°', '¨', '·', '¹', '³', '²', '■', ' '
];

export function decodeCp437(bytes: Uint8Array): string {
  let out = '';
  for (const byte of bytes) {
    if (byte < 0x80) {
      out += String.fromCharCode(byte);
    } else {
      out += CP437_TABLE[byte - 0x80] ?? '�';
    }
  }
  return out;
}
